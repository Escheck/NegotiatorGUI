<?xml version="1.0" encoding="UTF-8"?>
<!--
	An Ant script to make distributives for the Negotiator: 
	- Use makeAllJars to build all packages.
	- Use makeDistributiveForStudents to build zip package that 
	  can be distributed to the sutdents of AI course
--> 
	
<project name="Negotiator" default="makeAllJars" basedir=".">
	<property name="dist" location="dist"/> 
	<property name="build" location="bin"/>
	<property name="tmp" location="tmp"/>
	<property name="dep" location="dep"/>
	<target name="cleanup">
		<delete includeemptydirs="true" quiet="true">
			<fileset dir="${tmp}"/>
		</delete>				
	</target>
	<target name="makeTempDir">
		<mkdir dir="${tmp}"/>
	</target>
	<target name="unpackJTreeTable" depends="makeTempDir">		
		<unzip src="${dep}/jtreetable.jar" dest="${tmp}"/>
	</target>
	<target name="unpackAbsoluteLayout" depends="makeTempDir">
		<unzip src="${dep}/absolutelayout.jar" dest="${tmp}"/>
	</target>
	<target name="unpackJCCKit" depends="makeTempDir">
		<unzip src="${dep}/jcckit.jar" dest="${tmp}"/> 		
	</target>		
	<target name ="makeNegoEditorJar" description="Create a jar for the Negotiation Editor" depends="cleanup, unpackJTreeTable">
	     <delete file="${dist}/negoeditor.jar" quiet="true"/>
         <jar destfile="${dist}/negoeditor.jar"  >
			<fileset dir="${build}" excludes="negotiator/actions"/>
			<fileset dir="${tmp}"/>
	    	<manifest>
      			<attribute name="Built-By" value="${user.name}"/>
				<attribute name="Main-Class" value="negotiator/MainEditor"/>
    		</manifest>		
		</jar>	         
		<ant target="cleanup"/>
    </target>
	<target name ="makeNegoSimulatorJar" description="Create a jar for the Negotiation Simulator" depends="cleanup, unpackJTreeTable, unpackAbsoluteLayout, unpackJCCKit">
   		<delete file="${dist}/negosimulator.jar" quiet="true"/>
         <jar destfile="${dist}/negosimulator.jar">
			<fileset dir="${build}"/>
			<fileset dir="${tmp}"/>
	    	<manifest>
      			<attribute name="Built-By" value="${user.name}"/>
				<attribute name="Main-Class" value="negotiator/Main"/>
    		</manifest>		
		</jar>	         
		<ant target="cleanup"/>
    </target>
	<target name ="makeAllJars" description="Creates all jar files" depends="makeNegoEditorJar, makeNegoSimulatorJar"/>
	<target name ="makeDistributiveForStudentsOn14Nov" depends="makeAllJars">
		<zip destfile="${dist}/negotiator14Nov.zip">
			<zipfileset dir="${dist}" includes="negosimulator.jar"/>
			<zipfileset dir="${dist}" includes="negoeditor.jar"/>
			<zipfileset dir="etc/templates/partydomain" prefix="templates/partydomain"/>
		</zip>
	</target>
	<target name ="makeDistributiveForStudentsOn4Nov" depends="makeAllJars">
		<zip destfile="${dist}/negotiator4Nov.zip">
			<zipfileset dir="${dist}" includes="negosimulator.jar" prefix="negotiator"/>
			<zipfileset dir="${dist}" includes="negoeditor.jar" prefix="negotiator"/>
			<zipfileset dir="etc/templates" includes="inheritance*.*" prefix="negotiator/templates/"/>
			<zipfileset dir="doc" includes="assignment.pdf" prefix="negotiator"/>
			<zipfileset dir="doc" includes="guide.pdf" prefix="negotiator"/>
			<zipfileset dir="src/agents" includes="SimpleAgent.java" prefix="negotiator/agents"/>
			<zipfileset dir="${build}/agents" includes="SimpleAgent.class" prefix="negotiator/agents"/>
			<zipfileset dir="etc/templates/partydomain" prefix="templates/partydomain"/>
		</zip>
	</target>

</project> 

